분류모형의 예측력을 평가하는 지표 = 성능평가
confusion matrix
-정확도 = 정분류율
--전체분석 대상중에서 실제값과 예측값이 일치한 비율
--정확도가 높다 = False Positive 오류와 False Negative 오류가 작다
--클래스가 불균형한 경우에는 정확도만 가지고 판단하면 모델의 신뢰도가 떨어지므로, 정밀도와 재현율을 같이 고려하여판단
-오분류율 = 1- 정분류율(정확도)

-정밀도
--True 로 예측한 분석 대상중에서 실제값이 True인 비율 = 양성예측도
=> 예측한 것들 중 얼마나 맞췄는가? = 모델정확도
-예측값이 얼마나 정확한지 측정
--정밀도가 높다 = False Positive 오류가 작다
예) 스팸메일분류 등

재현율 = 민감도 = 소수집단 정분류율
--실제 값이 True인 분석대상중에서  True로 예측하여 모형이 적중한 비율 = 민감도
=> 실제 참인것들 중에서 얼마나 잘 예측(재현) 하였는가?
-실제 정답을 얼마나 맞췄는지 측정
-재현율이 높다 = False Negative오류가 작다

-소수집단 오분류율 
 1- 소수집단 정분류율(재현율, 민감도)

-특이도
--실제값이 False인 분석 대상 중에서 False로 예측하여 모형이 적중한 비율
--임상시험이나 진단 검사의 정확도를 표현하는 용어
--민감도 = 양성정확도/특이도 = 정상정확도

-F1 지표
--정밀도와 재현율이 균등하게 반영될 수 있도록 정밀도와 재현율의 조화 평균
--정밀도와 재현율을 종합적으로 파악
--모형의 예측력을 종합적으로 평가하는 지표
--값이 높을수록 분류 모형의 예측력이 좋다

분류 모델 평가를 위한 주요 지표
1. 혼동행렬(Confusion Matrix)

모델 예측 결과를 실제값(참/거짓)과 비교해 4가지 경우(True Positive, False Positive, True Negative, False Negative)로 정리한 표
이를 바탕으로 정확도, 정밀도, 재현율, 특이도 등의 지표를 계산
2. 정확도(Accuracy)

정의: 전체 데이터 중 실제값과 예측값이 일치한 비율
정확도
=
정답 맞춘 개수
전체 데이터 수
정확도= 
전체 데이터 수
정답 맞춘 개수
​
 
해석: 정확도가 높을수록 예측이 전반적으로 잘 맞았음을 의미
주의점: 데이터의 클래스(레이블)가 편중되어 있으면(예: 전체 중 99%가 한 클래스) 정확도만 봐서는 모델 성능을 오판할 수 있음. 따라서 정밀도(Precision)와 재현율(Recall)도 함께 확인하는 것이 좋다.
3. 오분류율(Error Rate)

정의: 틀린 예측 비율로, 1 - 정확도로 계산
오분류율
=
1
−
정확도
오분류율=1−정확도
4. 정밀도(Precision)

정의: 모델이 ‘양성(참)’이라고 예측한 것 중 실제로 참인 비율
정밀도
=
TP
TP + FP
정밀도= 
TP + FP
TP
​
 
(TP: True Positive, FP: False Positive)
해석: 정밀도가 높다는 것은 “예측한 양성들 중에서 진짜 양성 비율”이 높다는 뜻, 즉 거짓 양성(FP)이 적다는 의미
적합한 상황: 스팸메일 필터링처럼, 잘못 양성으로 판단해 중요한 메일을 스팸으로 버리지 않도록 하는 상황에서 중요하게 쓰임
5. 재현율(Recall) = 민감도(Sensitivity)

정의: 실제 참인 것들 중에서 모델이 참으로 맞춘 비율
재현율
=
TP
TP + FN
재현율= 
TP + FN
TP
​
 
(FN: False Negative)
해석: 재현율이 높다는 것은 실제 참인 데이터를 놓치지 않고 잘 잡아낸다는 의미. 거짓 음성(FN)이 적음.
적합한 상황: 질병 진단처럼, 실제 양성을 놓치면 큰 문제가 발생하는 상황에서 중요
6. 특이도(Specificity)

정의: 실제 거짓(False)인 것들 중 거짓으로 정확히 맞춘 비율
특이도
=
TN
TN + FP
특이도= 
TN + FP
TN
​
 
(TN: True Negative)
해석: 특이도가 높다는 것은 ‘실제로 음성인 데이터’를 음성으로 잘 분류한다는 의미. FN과 비슷한 개념이 양성에 집중했다면, 특이도는 음성 측면에서의 정확도를 보는 지표.
적합한 상황: 의료 진단에서 정상인을 잘 정상으로 판별하는 능력을 평가할 때 사용
7. F1 점수(F1 Score)

정의: 정밀도와 재현율의 조화평균(Harmonic Mean)
𝐹
1
=
2
×
정밀도 × 재현율
정밀도 + 재현율
F1=2× 
정밀도 + 재현율
정밀도 × 재현율
​
 
해석: 정밀도와 재현율을 균형 있게 고려한 종합 평가 지표. 두 지표 모두 고르게 높은 모델일수록 F1 점수가 높아짐.
적합한 상황: 데이터 불균형 문제가 있는 경우, 단순 정확도보다 F1을 보면 모델 성능을 더 공정하게 평가할 수 있음.
요약
정확도(Accuracy): 전체적으로 얼마나 맞췄나?
정밀도(Precision): 예측을 참이라고 한 것들 중 진짜 참이 얼마나 많은가? (거짓 양성 최소화)
재현율(Recall): 실제 참인 것들을 얼마나 잘 놓치지 않고 잡았나? (거짓 음성 최소화)
F1 점수: 정밀도와 재현율 사이의 균형 잡힌 평가



다중분류

-3개 이상의 클래스 분류
--소프트맥스 함수
---클래스마다 z값을 계산하여 확률로 변환
---이진 분류처럼 클래스마다 선형 방정식을 만들어 출력
-----해당 클래스만 양성, 나머지 모두 음성 클래스로 두고 이진분류(OvR, One versus Rest)
-----클래스마다 시그모이드 함수 적용하여 확률을 구하면 그 합이 1이 될 수 없음
-----z값을 지수화(지수 함수)를 이용 = 소프트맥스 함수를 적용하면 그 합이 1이됨
---전체 지구함수 합으로 나누어 정규화하는 방식


분류에서의 손실
-정답을 맞히지 못하는 것
-예측* 정답(타깃) => -ln하는 이유는 음수보다 양수가 해석하기 용이하기 때문

손실함수
-샘플 하나에 대한 손실을 정의
예) 분류에서의 손실 = 정답을 못맞히는 것= 정확도
--정확도 값의 수가 제한적이고 연속적이지 않은 모양이르모 손실 함수로 부적합

-손실 함수는 미분 가능한 연속적인 모양이어야 함
-예) 로지스틱 손실 함수 = 이진 크로스엔트로피 손실 함수
--타깃이 1: -log(예측확률) / 타깃이 0: -log(1-예측확률)
--음수를 취하면 최종값이 양수가 되어 해석이 쉬움
--확률이 1에서 멀어질수록 큰 양수/ 0에서 멀어질수록 큰 양수, 큰양수 = 손실이 크다

-다중분류는 크로스엔트로피 손실함수
-회귀에서는 평균 제곱 오차 / 평균 절대값 오차
-값이 작을수록 좋음




경사 하강법
-데이터에 적합한 머신러닝 모델의 최적화 문제 해결방법
--분석 솔루션과 반복 솔루션으로 나눔
--예) 선형회귀 vs 로지스틱 회귀
-반복 솔루션
--경사 하강법: 최적의 솔루션을 향해 점진적으로 나아가 매우 다양한 상황에서 상ㅇ됨
--임의의 추측지점에서 시작하여 한번에 하나씩 개선해나가면서 최적의 해를 찾을때까지 (최대반복) 계속 진행

-선형회귀 - 분석 솔루션이 있지만 반복 솔루션으로 설명해보자!
--최적화대상; 절편, 기울기(파라미터)
--최적화목표: 오차 최소화(오차제곱합(SSE), 평균제곱오차(MSE))
--오차제곱합으로 절편만 생각해보자!
---기울기가 고정되어있고, 절편을 0부터 시작하여 최적화
---오차: 실제값-예측값(=절편+기울기*변수))^2
---손실함수 = 비용함수 -> 오차제곱합

-언제까지 또는 얼마나 최적화할 것인가?

미분: 접선의 기울기와 부호
--기울기가 크다 = 미분한 값이 크다 = 아직 최적화에 멀었다
--음의 미분값 = 오른쪽으로 이동
--기울기가 작다 = 미분한 값이 작다 = 최적화에 가까워졌다
--양의 미분값 = 왼쪽으로 이동

결론: 어떤 방향으로 가야 하는가 / 얼마나 크게,작게 가야하는가

--스텝크기(보폭) = 미분값 * 학습률

경사하강법은 아주 많은 계산량으로 매우 느림
--확률적 경사하강법: 임의로 하나의 데이터를 선택


확률적 경사하강법

정의: 하나의 샘플을 랜덤하게 선택하여 경사를 내려가는 방법

미니배치 경사 하강법
정의: 하나의 샘플이 아닌 몇개의 샘플을 선택해서 경사를 내려가는 방법

배치경사하강법
정의: 전체 샘플을 사용하여 극단적으로 한번 경사로를 따라 이동하는 방법

신경망 알고리즘은 반드시 확률적 경사 하강법을 사용한다
-일반적으로 많은 데이터를 사용하므로 한 번에 모든 데이터를 사용하기 어려움


확률적 경사 하강법을 사용한 모델
-에포크 횟수에 따라 과소적합이나 과대적합이 될 수 있음
-에포크 횟수가 적으면 과소적합: 훈련 세트와 테스트 세트에 잘 맞지 않음
-에포크 횟수가 충분히 많으면 과대적합: 훈련 세트에 너무 잘 맞아 테스트 세트에는 오히려 점수가 나쁨

이를 시각화 한 것이 손실 곡선













